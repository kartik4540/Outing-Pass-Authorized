{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\91989\\\\Desktop\\\\SRMLAB - Copy\\\\react-version\\\\src\\\\components\\\\ProtectedRoute.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport { supabase } from '../supabaseClient';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProtectedRoute = ({\n  children\n}) => {\n  _s();\n  const [loading, setLoading] = useState(true);\n  const navigate = useNavigate();\n  useEffect(() => {\n    const checkUser = async () => {\n      try {\n        const {\n          data: {\n            session\n          },\n          error\n        } = await supabase.auth.getSession();\n        console.log('Session check:', {\n          session,\n          error\n        });\n        if (error) {\n          console.error('Session error:', error);\n          throw error;\n        }\n        if (!session) {\n          console.log('No session found, redirecting to auth');\n          navigate('/auth');\n          return;\n        }\n\n        // If we have a session, verify it's still valid\n        const {\n          data: {\n            user\n          }\n        } = await supabase.auth.getUser();\n        if (!user) {\n          console.log('No user found, redirecting to auth');\n          navigate('/auth');\n          return;\n        }\n        console.log('Valid session found:', user);\n        setLoading(false);\n      } catch (error) {\n        console.error('Error checking auth status:', error);\n        navigate('/auth');\n      }\n    };\n\n    // Check for existing session\n    checkUser();\n\n    // Set up auth state change listener\n    const {\n      data: {\n        subscription\n      }\n    } = supabase.auth.onAuthStateChange(async (event, session) => {\n      console.log('Auth state changed:', event, session);\n      if (event === 'SIGNED_OUT') {\n        navigate('/auth');\n      } else if (event === 'SIGNED_IN' && session) {\n        setLoading(false);\n      }\n    });\n\n    // Cleanup subscription\n    return () => {\n      if (subscription) subscription.unsubscribe();\n    };\n  }, [navigate]);\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        height: '100vh'\n      },\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this);\n  }\n  return children;\n};\n_s(ProtectedRoute, \"y3JVj3H+DZT4skK8GcW7cVdM7zQ=\", false, function () {\n  return [useNavigate];\n});\n_c = ProtectedRoute;\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["useEffect","useState","supabase","useNavigate","jsxDEV","_jsxDEV","ProtectedRoute","children","_s","loading","setLoading","navigate","checkUser","data","session","error","auth","getSession","console","log","user","getUser","subscription","onAuthStateChange","event","unsubscribe","style","display","justifyContent","alignItems","height","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/91989/Desktop/SRMLAB - Copy/react-version/src/components/ProtectedRoute.js"],"sourcesContent":["import { useEffect, useState } from 'react'\r\nimport { supabase } from '../supabaseClient'\r\nimport { useNavigate } from 'react-router-dom'\r\n\r\nconst ProtectedRoute = ({ children }) => {\r\n  const [loading, setLoading] = useState(true)\r\n  const navigate = useNavigate()\r\n\r\n  useEffect(() => {\r\n    const checkUser = async () => {\r\n      try {\r\n        const { data: { session }, error } = await supabase.auth.getSession()\r\n        console.log('Session check:', { session, error })\r\n        \r\n        if (error) {\r\n          console.error('Session error:', error)\r\n          throw error\r\n        }\r\n        \r\n        if (!session) {\r\n          console.log('No session found, redirecting to auth')\r\n          navigate('/auth')\r\n          return\r\n        }\r\n\r\n        // If we have a session, verify it's still valid\r\n        const { data: { user } } = await supabase.auth.getUser()\r\n        if (!user) {\r\n          console.log('No user found, redirecting to auth')\r\n          navigate('/auth')\r\n          return\r\n        }\r\n\r\n        console.log('Valid session found:', user)\r\n        setLoading(false)\r\n      } catch (error) {\r\n        console.error('Error checking auth status:', error)\r\n        navigate('/auth')\r\n      }\r\n    }\r\n\r\n    // Check for existing session\r\n    checkUser()\r\n\r\n    // Set up auth state change listener\r\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(async (event, session) => {\r\n      console.log('Auth state changed:', event, session)\r\n      if (event === 'SIGNED_OUT') {\r\n        navigate('/auth')\r\n      } else if (event === 'SIGNED_IN' && session) {\r\n        setLoading(false)\r\n      }\r\n    })\r\n\r\n    // Cleanup subscription\r\n    return () => {\r\n      if (subscription) subscription.unsubscribe()\r\n    }\r\n  }, [navigate])\r\n\r\n  if (loading) {\r\n    return (\r\n      <div style={{ \r\n        display: 'flex', \r\n        justifyContent: 'center', \r\n        alignItems: 'center', \r\n        height: '100vh' \r\n      }}>\r\n        Loading...\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return children\r\n}\r\n\r\nexport default ProtectedRoute "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}