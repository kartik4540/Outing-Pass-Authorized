{"ast":null,"code":"// Export API_BASE_URL for use in other files\nexport const API_BASE_URL = 'http://localhost:5000/api';\n\n/**\n * Check if the API server is running\n * @returns {Promise<boolean>} True if the API is healthy, false otherwise\n */\nexport const checkApiHealth = async () => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/health`);\n    return response.ok;\n  } catch (error) {\n    console.error('Health check error:', error);\n    return false;\n  }\n};\n\n/**\n * Helper function to handle API responses\n * @param {Response} response - The fetch response object\n * @returns {Promise<any>} - Parsed JSON response\n */\nasync function handleResponse(response) {\n  const contentType = response.headers.get(\"content-type\");\n  if (!contentType || !contentType.includes(\"application/json\")) {\n    const text = await response.text();\n    console.error('Non-JSON response:', text);\n    throw new Error('Backend server error. Please make sure the server is running.');\n  }\n  const data = await response.json();\n  if (!response.ok) {\n    throw new Error(data.error || data.message || 'API request failed');\n  }\n  return data;\n}\n\n/**\n * Fetch available seats for a given date and lab\n * @param {string} date - The date to fetch available seats for\n * @param {string} lab - The lab to fetch available seats for\n * @returns {Promise<Object>} - Available seats data\n */\nexport const fetchAvailableSeats = async (date, lab) => {\n  const response = await fetch(`${API_BASE_URL}/available-seats?date=${date}&lab=${lab}`);\n  return handleResponse(response);\n};\n\n/**\n * Book a lab slot\n * @param {Object} bookingData - The booking data\n * @returns {Promise<Object>} - Booking confirmation\n */\nexport const bookSlot = async bookingData => {\n  // Ensure timeSlots is an array\n  if (bookingData.timeSlot) {\n    bookingData.timeSlots = [bookingData.timeSlot];\n    delete bookingData.timeSlot;\n  } else if (!bookingData.timeSlots) {\n    bookingData.timeSlots = [];\n  }\n\n  // Validate required fields\n  if (!bookingData.date || !bookingData.lab || !bookingData.timeSlots || bookingData.timeSlots.length === 0) {\n    throw new Error('Missing required fields: date, lab, and at least one time slot are required.');\n  }\n  const response = await fetch(`${API_BASE_URL}/book-slot`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(bookingData)\n  });\n\n  // Log the request for debugging\n  console.log('Booking request:', {\n    url: `${API_BASE_URL}/book-slot`,\n    method: 'POST',\n    data: bookingData\n  });\n  const data = await handleResponse(response);\n\n  // Log the response for debugging\n  console.log('Booking response:', data);\n  return data;\n};\n\n/**\n * Fetch booked slots for a user\n * @param {string} email - The user's email\n * @returns {Promise<Array>} - Array of booked slots\n */\nexport const fetchBookedSlots = async email => {\n  const response = await fetch(`${API_BASE_URL}/booked-slots?email=${encodeURIComponent(email)}`);\n  return handleResponse(response);\n};\n\n/**\n * Delete a booked slot\n * @param {number} slotId - The slot ID to delete\n * @returns {Promise<Object>} - Deletion confirmation\n */\nexport const deleteBookedSlot = async slotId => {\n  const response = await fetch(`${API_BASE_URL}/delete-slot/${slotId}`, {\n    method: 'DELETE'\n  });\n  return handleResponse(response);\n};\n\n/**\n * Fetch pending bookings (admin only)\n * @param {string} adminEmail - The admin's email\n * @returns {Promise<Array>} - Array of pending bookings\n */\nexport const fetchPendingBookings = async adminEmail => {\n  const response = await fetch(`${API_BASE_URL}/admin/pending-bookings?admin_email=${encodeURIComponent(adminEmail)}`);\n  return handleResponse(response);\n};\n\n/**\n * Handle booking action (confirm/reject)\n * @param {number} bookingId - The booking ID to update\n * @param {string} action - The action to perform ('confirm' or 'reject')\n * @param {string} adminEmail - The admin's email\n * @returns {Promise<Object>} - Action confirmation\n */\nexport const handleBookingAction = async (bookingId, action, adminEmail) => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/admin/booking/${bookingId}`, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        admin_email: adminEmail,\n        action: action\n      })\n    });\n\n    // Log the response for debugging\n    console.log('Booking action response:', {\n      status: response.status,\n      statusText: response.statusText,\n      headers: Object.fromEntries(response.headers.entries())\n    });\n    return handleResponse(response);\n  } catch (error) {\n    console.error('Error in handleBookingAction:', error);\n    throw new Error(error.message || 'Failed to update booking status');\n  }\n};\n\n/**\n * Fetch day order for a given date\n * @param {string} date - The date to get day order for\n * @returns {Promise<number>} - The day order (1-5)\n */\nexport const fetchDayOrder = async date => {\n  const response = await fetch(`${API_BASE_URL}/day-order?date=${encodeURIComponent(date)}`);\n  const data = await handleResponse(response);\n  return data.day_order;\n};\n\n/**\n * Set a new day order reference (admin only)\n * @param {string} adminEmail - The admin's email\n * @param {string} referenceDate - The reference date in YYYY-MM-DD format\n * @param {number} dayOrder - The day order (1-5)\n * @returns {Promise<Object>} - Response from the server\n */\nexport const setDayOrderReference = async (adminEmail, referenceDate, dayOrder) => {\n  const response = await fetch(`${API_BASE_URL}/admin/set-day-order-reference`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      admin_email: adminEmail,\n      reference_date: referenceDate,\n      day_order: dayOrder\n    })\n  });\n  return handleResponse(response);\n};\n\n/**\n * Get day order reference history (admin only)\n * @param {string} adminEmail - The admin's email\n * @returns {Promise<Array>} - Array of day order references\n */\nexport const getDayOrderReferences = async adminEmail => {\n  const response = await fetch(`${API_BASE_URL}/admin/day-order-references?admin_email=${encodeURIComponent(adminEmail)}`);\n  return handleResponse(response);\n};","map":{"version":3,"names":["API_BASE_URL","checkApiHealth","response","fetch","ok","error","console","handleResponse","contentType","headers","get","includes","text","Error","data","json","message","fetchAvailableSeats","date","lab","bookSlot","bookingData","timeSlot","timeSlots","length","method","body","JSON","stringify","log","url","fetchBookedSlots","email","encodeURIComponent","deleteBookedSlot","slotId","fetchPendingBookings","adminEmail","handleBookingAction","bookingId","action","admin_email","status","statusText","Object","fromEntries","entries","fetchDayOrder","day_order","setDayOrderReference","referenceDate","dayOrder","reference_date","getDayOrderReferences"],"sources":["C:/Users/91989/Desktop/SRMLAB - Copy/react-version/src/services/api.js"],"sourcesContent":["// Export API_BASE_URL for use in other files\nexport const API_BASE_URL = 'http://localhost:5000/api';\n\n/**\n * Check if the API server is running\n * @returns {Promise<boolean>} True if the API is healthy, false otherwise\n */\nexport const checkApiHealth = async () => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/health`);\n    return response.ok;\n  } catch (error) {\n    console.error('Health check error:', error);\n    return false;\n  }\n};\n\n/**\n * Helper function to handle API responses\n * @param {Response} response - The fetch response object\n * @returns {Promise<any>} - Parsed JSON response\n */\nasync function handleResponse(response) {\n  const contentType = response.headers.get(\"content-type\");\n  if (!contentType || !contentType.includes(\"application/json\")) {\n    const text = await response.text();\n    console.error('Non-JSON response:', text);\n    throw new Error('Backend server error. Please make sure the server is running.');\n  }\n  \n  const data = await response.json();\n  if (!response.ok) {\n    throw new Error(data.error || data.message || 'API request failed');\n  }\n  return data;\n}\n\n/**\n * Fetch available seats for a given date and lab\n * @param {string} date - The date to fetch available seats for\n * @param {string} lab - The lab to fetch available seats for\n * @returns {Promise<Object>} - Available seats data\n */\nexport const fetchAvailableSeats = async (date, lab) => {\n  const response = await fetch(`${API_BASE_URL}/available-seats?date=${date}&lab=${lab}`);\n  return handleResponse(response);\n};\n\n/**\n * Book a lab slot\n * @param {Object} bookingData - The booking data\n * @returns {Promise<Object>} - Booking confirmation\n */\nexport const bookSlot = async (bookingData) => {\n  // Ensure timeSlots is an array\n  if (bookingData.timeSlot) {\n    bookingData.timeSlots = [bookingData.timeSlot];\n    delete bookingData.timeSlot;\n  } else if (!bookingData.timeSlots) {\n    bookingData.timeSlots = [];\n  }\n\n  // Validate required fields\n  if (!bookingData.date || !bookingData.lab || !bookingData.timeSlots || bookingData.timeSlots.length === 0) {\n    throw new Error('Missing required fields: date, lab, and at least one time slot are required.');\n  }\n\n  const response = await fetch(`${API_BASE_URL}/book-slot`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify(bookingData),\n  });\n\n  // Log the request for debugging\n  console.log('Booking request:', {\n    url: `${API_BASE_URL}/book-slot`,\n    method: 'POST',\n    data: bookingData\n  });\n\n  const data = await handleResponse(response);\n\n  // Log the response for debugging\n  console.log('Booking response:', data);\n\n  return data;\n};\n\n/**\n * Fetch booked slots for a user\n * @param {string} email - The user's email\n * @returns {Promise<Array>} - Array of booked slots\n */\nexport const fetchBookedSlots = async (email) => {\n  const response = await fetch(`${API_BASE_URL}/booked-slots?email=${encodeURIComponent(email)}`);\n  return handleResponse(response);\n};\n\n/**\n * Delete a booked slot\n * @param {number} slotId - The slot ID to delete\n * @returns {Promise<Object>} - Deletion confirmation\n */\nexport const deleteBookedSlot = async (slotId) => {\n  const response = await fetch(`${API_BASE_URL}/delete-slot/${slotId}`, {\n    method: 'DELETE',\n  });\n  return handleResponse(response);\n};\n\n/**\n * Fetch pending bookings (admin only)\n * @param {string} adminEmail - The admin's email\n * @returns {Promise<Array>} - Array of pending bookings\n */\nexport const fetchPendingBookings = async (adminEmail) => {\n  const response = await fetch(`${API_BASE_URL}/admin/pending-bookings?admin_email=${encodeURIComponent(adminEmail)}`);\n  return handleResponse(response);\n};\n\n/**\n * Handle booking action (confirm/reject)\n * @param {number} bookingId - The booking ID to update\n * @param {string} action - The action to perform ('confirm' or 'reject')\n * @param {string} adminEmail - The admin's email\n * @returns {Promise<Object>} - Action confirmation\n */\nexport const handleBookingAction = async (bookingId, action, adminEmail) => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/admin/booking/${bookingId}`, {\n      method: 'PATCH',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        admin_email: adminEmail,\n        action: action\n      }),\n    });\n    \n    // Log the response for debugging\n    console.log('Booking action response:', {\n      status: response.status,\n      statusText: response.statusText,\n      headers: Object.fromEntries(response.headers.entries())\n    });\n    \n    return handleResponse(response);\n  } catch (error) {\n    console.error('Error in handleBookingAction:', error);\n    throw new Error(error.message || 'Failed to update booking status');\n  }\n};\n\n/**\n * Fetch day order for a given date\n * @param {string} date - The date to get day order for\n * @returns {Promise<number>} - The day order (1-5)\n */\nexport const fetchDayOrder = async (date) => {\n  const response = await fetch(`${API_BASE_URL}/day-order?date=${encodeURIComponent(date)}`);\n  const data = await handleResponse(response);\n  return data.day_order;\n};\n\n/**\n * Set a new day order reference (admin only)\n * @param {string} adminEmail - The admin's email\n * @param {string} referenceDate - The reference date in YYYY-MM-DD format\n * @param {number} dayOrder - The day order (1-5)\n * @returns {Promise<Object>} - Response from the server\n */\nexport const setDayOrderReference = async (adminEmail, referenceDate, dayOrder) => {\n  const response = await fetch(`${API_BASE_URL}/admin/set-day-order-reference`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      admin_email: adminEmail,\n      reference_date: referenceDate,\n      day_order: dayOrder\n    }),\n  });\n  return handleResponse(response);\n};\n\n/**\n * Get day order reference history (admin only)\n * @param {string} adminEmail - The admin's email\n * @returns {Promise<Array>} - Array of day order references\n */\nexport const getDayOrderReferences = async (adminEmail) => {\n  const response = await fetch(`${API_BASE_URL}/admin/day-order-references?admin_email=${encodeURIComponent(adminEmail)}`);\n  return handleResponse(response);\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}